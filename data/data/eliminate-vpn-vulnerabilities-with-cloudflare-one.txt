  Eliminate VPN vulnerabilities with Cloudflare One                        Get Started Free|Contact SalesThe Cloudflare BlogSubscribe to receive notifications of new posts:SubscribeAll PostsProduct NewsSpeed & ReliabilitySecurityZero TrustDevelopersAIPolicyPartnersLife at CloudflareAll PostsProduct NewsSpeed & ReliabilitySecurityZero TrustDevelopersAIPolicyPartnersLife at CloudflareEliminate VPN vulnerabilities with Cloudflare One03/06/2024Dan HallMichael Keane4 min readOn January 19, 2024, the Cybersecurity & Infrastructure Security Agency (CISA) issued Emergency Directive 24-01: Mitigate Ivanti Connect Secure and Ivanti Policy Secure Vulnerabilities. CISA has the authority to issue emergency directives in response to a known or reasonably suspected information security threat, vulnerability, or incident. U.S. Federal agencies are required to comply with these directives.Federal agencies were directed to apply a mitigation against two recently discovered vulnerabilities; the mitigation was to be applied within three days. Further monitoring by CISA revealed that threat actors were continuing to exploit the vulnerabilities and had developed some workarounds to earlier mitigations and detection methods. On January 31, CISA issued Supplemental Direction V1 to the Emergency Directive instructing agencies to immediately disconnect all instances of Ivanti Connect Secure and Ivanti Policy Secure products from agency networks and perform several actions before bringing the products back into service.This blog post will explore the threat actorâs tactics, discuss the high-value nature of the targeted products, and show how Cloudflareâs Secure Access Service Edge (SASE) platform protects against such threats.As a side note and showing the value of layered protections, Cloudflareâs WAF had proactively detected the Ivanti zero-day vulnerabilities and deployed emergency rules to protect Cloudflare customers.Threat Actor TacticsForensic investigations (see the Volexity blog for an excellent write-up) indicate that the attacks began as early as December 2023. Piecing together the evidence shows that the threat actors chained two previously unknown vulnerabilities together to gain access to the Connect Secure and Policy Secure appliances and achieve unauthenticated remote code execution (RCE). CVE-2023-46805 is an authentication bypass vulnerability in the productsâ web components that allows a remote attacker to bypass control checks and gain access to restricted resources. CVE-2024-21887 is a command injection vulnerability in the productsâ web components that allows an authenticated administrator to execute arbitrary commands on the appliance and send specially crafted requests. The remote attacker was able to bypass authentication and be seen as an âauthenticatedâ administrator, and then take advantage of the ability to execute arbitrary commands on the appliance.By exploiting these vulnerabilities, the threat actor had near total control of the appliance. Among other things, the attacker was able to:Harvest credentials from users logging into the VPN serviceUse these credentials to log into protected systems in search of even more credentialsModify files to enable remote code executionDeploy web shells to a number of web serversReverse tunnel from the appliance back to their command-and-control server (C2)Avoid detection by disabling logging and clearing existing logs Little Appliance, Big RiskThis is a serious incident that is exposing customers to significant risk. CISA is justified in issuing their directive, and Ivanti is working hard to mitigate the threat and develop patches for the software on their appliances. But it also serves as another indictment of the legacy âcastle-and-moatâ security paradigm. In that paradigm, remote users were outside the castle while protected applications and resources remained inside. The moat, consisting of a layer of security appliances, separated the two. The moat, in this case the Ivanti appliance, was responsible for authenticating and authorizing users, and then connecting them to protected applications and resources. Attackers and other bad actors were blocked at the moat.This incident shows us what happens when a bad actor is able to take control of the moat itself, and the challenges customers face to recover control. Two typical characteristics of vendor-supplied appliances and the legacy security strategy highlight the risks:Administrators have access to the internals of the applianceAuthenticated users indiscriminately have access to a wide range of applications and resources on the corporate network, increasing the risk of bad actor lateral movementA better way: Cloudflareâs SASE platformCloudflare One is Cloudflareâs SSE and single-vendor SASE platform. While Cloudflare One spans broadly across security and networking services (and you can read about the latest additions here), I want to focus on the two points noted above.First, Cloudflare One employs the principles of Zero Trust, including the principle of least privilege. As such, users that authenticate successfully only have access to the resources and applications necessary for their role. This principle also helps in the event of a compromised user account as the bad actor does not have indiscriminate network-level access. Rather, least privilege limits the range of lateral movement that a bad actor has, effectively reducing the blast radius.Second, while customer administrators need to have access to configure their services and policies, Cloudflare One does not provide any external access to the system internals of Cloudflareâs platform. Without that access, a bad actor would not be able to launch the types of attacks executed when they had access to the internals of the Ivanti appliance. Â Itâs time to eliminate the legacy VPNIf your organization is impacted by the CISA directive, or you are just ready to modernize and want to augment or replace your current VPN solution, Cloudflare is here to help. Cloudflareâs Zero Trust Network Access (ZTNA) service, part of the Cloudflare One platform, is the fastest and safest way to connect any user to any application.Contact us to get immediate onboarding help or to schedule an architecture workshop to help you augment or replace your Ivanti (or any) VPN solution.Not quite ready for a live conversation? Read our learning path article on how to replace your VPN with Cloudflare or our SASE reference architecture for a view of how all of our SASE services and on-ramps work together.We protect entire corporate networks, help customers build Internet-scale applications efficiently, accelerate any website or Internet application, ward off DDoS attacks, keep hackers at bay, and can help you on your journey to Zero Trust.Visit 1.1.1.1 from any device to get started with our free app that makes your Internet faster and safer.To learn more about our mission to help build a better Internet, start here. If you're looking for a new career direction, check out our open positions.Discuss on Hacker NewsSecurity WeekVPNCloudflare OneCloudflare AccessVulnerabilitiesAttacksApplication ServicesFollow on XCloudflare|@cloudflareRelated postsMarch 11, 2024  2:00 PMSecurity Week 2024 wrap upA summary of the blog posts and product announcements released during Security Week 2024...ByÂ Daniele Molteni,Â Ankur AggarwalSecurity Week,Â Zero Trust,Â Application Security,Â Email Security,Â AIÂ March 08, 2024  2:05 PMLog Explorer: monitor security events without third-party storageWith the combined power of Security Analytics + Log Explorer, security teams can analyze, investigate, and monitor for security attacks natively within Cloudflare, reducing time to resolution and overall cost of ownership for customers by eliminating the need to forward logs to third-party SIEMs...ByÂ Jen Sells,Â Claudio Jolowicz,Â Cole MacKenzieSecurity Week,Â Analytics,Â Logs,Â Security,Â R2 Storage,Â SIEM,Â Product NewsÂ March 08, 2024  2:00 PMLaunching email security insights on Cloudflare RadarThe new Email Security section on Cloudflare Radar provides insights into the latest trends around threats found in malicious email, sources of spam and malicious email, and the adoption of technologies designed to prevent abuse of email...ByÂ David BelsonSecurity Week,Â Cloudflare Radar,Â Email,Â Email Routing,Â Email Security,Â TrendsÂ March 08, 2024  2:00 PMProtocol detection with Cloudflare GatewayCloudflare Gateway, our secure web gateway (SWG), now supports the detection, logging, and filtering of network protocols using packet payloads without the need for inspection...ByÂ Ankur AggarwalSecurity Week,Â Cloudflare Gateway,Â Zero TrustÂ Getting StartedFree plansFor enterprisesCompare plansGet a recommendationRequest a demoContact SalesResourcesLearning CenterAnalyst reportsCloudflare RadarCloudflare TVCase StudiesWebinarsWhite PapersDeveloper docstheNetSolutionsConnectivity cloudSSE and SASE servicesApplication servicesNetwork servicesDeveloper servicesCommunityCommunity HubProject GalileoAthenian ProjectCloudflare for CampaignsCritical Infrastructure Defense ProjectConnect 2024SupportHelp centerCloudflare StatusComplianceGDPRTrust & SafetyCompanyAbout CloudflareOur teamInvestor relationsPressCareersDiversity, equity & inclusionImpact/ESGNetwork MapLogos & press kitBecome a partnerÂ© 2024 Cloudflare, Inc. | Privacy Policy | Terms of Use | Report Security Issues |Cookie Preferences | Trademark 